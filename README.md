# Тест на Oracle SQL developer

Задача: Написать SQL запрос на диалекте Oracle для получения выгрузки определенного вида (Таблица 1) на основании предоставленных источников  (Tab2 и Tab3). Итоги в таблице считаем запросом обязательно.

Таблица 1, вид выгрузки, которую необходимо получить запросом:

№ поставки|Кол-во |Кол-во  |Кол-во  |Кол-во   |Сумма    |Кол-во |Кол-во   |Сумма    |Кол-во    |Сумма     |
          |агентов|отгружен|утилизи |проданных|проданных|агентов|проданных|проданных|отмененных|отмененных|  
          |       |оффлайн |товаров |оффлайн  |оффлайн  |       |товаров  |товаров  |товаров   |товаров   |
          |оффлайн|ных     |рованных|товаров  |товаров  |онлайн |онлайн   |онлайн   |онлайн    |онлайн    |
	  |       |товаров |оффлайн |         |         |       |         |         |          |          |
   _______|_______|________|________|_________|_________|_______|_________|_________|__________|__________|
     1    |       |        |        |         |         |       |         |         |          |          |
   _______|_______|________|________|_________|_________|_______|_________|_________|__________|__________|
     2    |       |        |        |         |         |       |         |         |          |          |
   _______|_______|________|________|_________|_________|_______|_________|_________|__________|__________|
   Итого  |       |        |        |         |         |       |         |         |          |          |

   Оффлайн продажи - Tab2                                                              Онлайн продажи -  Tab3
   _________________________________________________________________       _____________________________________________________      
   № поставки  |№ агента  |Флаг      |Флаг      |Цена    |№ Товара  |      № поставки  |№ агента  |Тип      |Сумма   |№ Товара  |      
  (ID_delivery)|(ID_agent)|Отгрузки  |утилизации|(Amount)|(ID_trade)|     (ID_delivery)|(ID_agent)|операции |(Amount)|(ID_trade)| 
               |          |(IS_agent)|(IS_util) |        |          |                  |          |(ID_type)|        |          |
  _____________|__________|__________|__________|________|__________|      ____________|__________|_________|________|__________|
      1	       |    11	  |     y    |    y	|        |	11  |           1      |   52     |	1   |	100  |	   1    |
  _____________|__________|__________|__________|________|__________|      ____________|__________|_________|________|__________|
      1        |    11    |	y    |	  	|  100   |	12  |           1      |   52     |	2   |	100  |	   1    |
  _____________|__________|__________|__________|________|__________|      ____________|__________|_________|________|__________|
      1        |    12    |	y    |  	|  100   |	13  |           1      |   53     |	1   |	100  |	   2    |
  _____________|__________|__________|__________|________|__________|      ____________|__________|_________|________|__________|
      1	       |    12    |	y    |	  y	|        |	14  |           1      |   58     |	1   |	100  |	   3    |
  _____________|__________|__________|__________|________|__________|      ____________|__________|_________|________|__________|
      2	       |    12    |	y    |		|  100   |	11  |           1      |   58     |	1   |	100  |	   4    |
  _____________|__________|__________|__________|________|__________|      ____________|__________|_________|________|__________|
      2        |    12	  |	     |	        |        |	12  |           1      |   900    |	1   |	100  |	   5    |
  _____________|__________|__________|__________|________|__________|      ____________|__________|_________|________|__________|
      2	       |    13    |	y    |		|  100	 |      13  |           1      |   900    |	2   |	100  |	   5    | 
  _____________|__________|__________|__________|________|__________|      ____________|__________|_________|________|__________|
      2	       |    14    |	y    |	   	|  100   |	14  |           2      |    53    |	1   |	100  |	   1    |
  _____________|__________|__________|__________|________|__________|      ____________|__________|_________|________|__________|
      2	       |    11	  |     y    |    y     |	 |	15  |           2      |    60    |	1   |	100  |	   2    |
  _____________|__________|__________|__________|________|__________|      ____________|__________|_________|________|__________|
                                                                           Типы операций: 1- продажа товара; 2 - отмена продажи


  

